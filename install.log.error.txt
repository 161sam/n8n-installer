dev@desktop-vm:~/n8n-installer$ sudo chmod +x scripts/debug_appflowy.sh
dev@desktop-vm:~/n8n-installer$ sudo bash scripts/debug_appflowy.sh
╭─────────────────────────────────────────────────────────────────╮
│ [INFO] 16:51:00: Starting AppFlowy & Affine Debug Analysis...   │
╰─────────────────────────────────────────────────────────────────╯

╭─────────────────────────────────────────────╮
│ [INFO] 16:51:00: === ENABLED SERVICES ===   │
╰─────────────────────────────────────────────╯
COMPOSE_PROFILES: n8n,flowise,monitoring,langfuse,qdrant,supabase,weaviate,neo4j,open-webui,searxng,crawl4ai,letta,appflowy,affine,cpu

✓ AppFlowy is enabled
✓ Affine is enabled

╭──────────────────────────────────────────────────────╮
│ [INFO] 16:51:00: === DOCKER COMPOSE VALIDATION ===   │
╰──────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────╮
│ [SUCCESS] 16:51:00: Docker Compose syntax is valid   │
╰──────────────────────────────────────────────────────╯

╭───────────────────────────────────────────╮
│ [INFO] 16:51:00: === SERVICE STATUS ===   │
╰───────────────────────────────────────────╯
NAME      STATE     STATUS

╭──────────────────────────────────────────────────────╮
│ [INFO] 16:51:01: === APPFLOWY SERVICE ANALYSIS ===   │
╰──────────────────────────────────────────────────────╯
Required AppFlowy variables:
  APPFLOWY_HOSTNAME: appflowy.ecospherenetwork.net
  APPFLOWY_POSTGRES_PASSWORD: SET
  APPFLOWY_JWT_SECRET: SET
  APPFLOWY_ADMIN_PASSWORD: SET
  APPFLOWY_MINIO_PASSWORD: SET

--- appflowy-postgres ---
╭────────────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: appflowy-postgres is not running   │
╰────────────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: appflowy-postgres

--- appflowy-redis ---
╭─────────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: appflowy-redis is not running   │
╰─────────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: appflowy-redis

--- appflowy-minio ---
╭─────────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: appflowy-minio is not running   │
╰─────────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: appflowy-minio

--- appflowy-gotrue ---
╭──────────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: appflowy-gotrue is not running   │
╰──────────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: appflowy-gotrue

--- appflowy-cloud ---
╭─────────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: appflowy-cloud is not running   │
╰─────────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: appflowy-cloud

--- appflowy-web ---
╭───────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: appflowy-web is not running   │
╰───────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: appflowy-web

=== APPFLOWY HEALTH CHECKS ===
appflowy-postgres: 
no-health-check
appflowy-redis: 
no-health-check
appflowy-minio: 
no-health-check
appflowy-gotrue: 
no-health-check
appflowy-cloud: 
no-health-check
appflowy-web: 
no-health-check

╭────────────────────────────────────────────────────╮
│ [INFO] 16:51:01: === AFFINE SERVICE ANALYSIS ===   │
╰────────────────────────────────────────────────────╯
Required Affine variables:
  AFFINE_HOSTNAME: affine.ecospherenetwork.net
  AFFINE_POSTGRES_PASSWORD: SET
  AFFINE_ADMIN_EMAIL: admin@ecospherenet.work
  AFFINE_ADMIN_PASSWORD: SET

--- affine-postgres ---
╭──────────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: affine-postgres is not running   │
╰──────────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: affine-postgres

--- affine-redis ---
╭───────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: affine-redis is not running   │
╰───────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: affine-redis

--- affine-migration ---
╭───────────────────────────────────────────────────────╮
│ [WARNING] 16:51:01: affine-migration is not running   │
╰───────────────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: affine-migration

--- affine ---
╭─────────────────────────────────────────────╮
│ [WARNING] 16:51:01: affine is not running   │
╰─────────────────────────────────────────────╯
Recent logs:
  Error response from daemon: No such container: affine

=== AFFINE HEALTH CHECKS ===
affine-postgres: 
no-health-check
affine-redis: 
no-health-check
affine: 
no-health-check

╭─────────────────────────────────────────────────╮
│ [INFO] 16:51:01: === NETWORK CONNECTIVITY ===   │
╰─────────────────────────────────────────────────╯
Testing AppFlowy internal connectivity:
Testing Affine internal connectivity:

╭───────────────────────────────────────────╮
│ [INFO] 16:51:01: === RESOURCE USAGE ===   │
╰───────────────────────────────────────────╯
Docker system resource usage:
TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE
Images          41        0         31.62GB   31.62GB (100%)
Containers      0         0         0B        0B
Local Volumes   24        0         7.281GB   7.281GB (100%)
Build Cache     0         0         0B        0B

Container resource usage:
CONTAINER   CPU %     MEM USAGE / LIMIT   MEM %

╭───────────────────────────────────────────────╮
│ [INFO] 16:51:01: === VOLUME INFORMATION ===   │
╰───────────────────────────────────────────────╯
AppFlowy volumes:
local     localai_appflowy_minio_data
local     localai_appflowy_postgres_data
local     localai_appflowy_redis_data
Affine volumes:
local     localai_affine_config
local     localai_affine_postgres_data
local     localai_affine_redis_data
local     localai_affine_storage

╭────────────────────────────────────────────╮
│ [INFO] 16:51:01: === RECOMMENDATIONS ===   │
╰────────────────────────────────────────────╯
🔧 Affine Migration Issues Detected:
   1. Check migration logs:
      docker logs affine-migration
   2. Try rerunning migration:
      docker compose -p localai up affine-migration

=== USEFUL COMMANDS ===
Restart all services:       docker compose -p localai restart
View service logs:          docker logs <container_name>
Check service health:       docker inspect <container_name> --format='{{.State.Health.Status}}'
Remove and recreate:        docker compose -p localai down && docker compose -p localai up -d

╭────────────────────────────────────────────────╮
│ [SUCCESS] 16:51:01: Debug analysis complete!   │
╰────────────────────────────────────────────────╯
If issues persist, please share the output of this script for further assistance.
dev@desktop-vm:~/n8n-installer$ sudo bash scripts/05_run_services.sh
╭──────────────────────────────────────────────────────────────────╮
│ [INFO] 16:51:13: Launching services using start_services.py...   │
╰──────────────────────────────────────────────────────────────────╯

==================================================
STARTING SERVICES SUMMARY
==================================================
Core Services (Always Enabled):
  ✓ n8n (Workflow Automation)
  ✓ Caddy (Reverse Proxy)
  ✓ PostgreSQL (Database)
  ✓ Redis (Cache)

Optional Services:
  ✓ Supabase (Backend as a Service)
  ✓ Flowise (AI Agent Builder)
  ✓ Open WebUI (ChatGPT Interface)
  ✓ AppFlowy (Knowledge Management)
  ✓ Affine (Collaborative Workspace)
  ✓ Qdrant (Vector Database)
  ✓ Weaviate (Vector Database)
  ✓ Neo4j (Graph Database)
  ✓ SearXNG (Private Search)
  ✓ Langfuse (AI Observability)
  ✓ Monitoring (Grafana + Prometheus)
  ✓ Crawl4AI (Web Crawler)
  ✓ Letta (Agent Server)
  ✓ Ollama (CPU)
==================================================

Supabase repository already exists, updating...
Running: git pull
remote: Enumerating objects: 48, done.
remote: Counting objects: 100% (47/47), done.
remote: Compressing objects: 100% (21/21), done.
Empfange Objekte: 100% (48/48), 12.13 KiB | 12.13 MiB/s, fertig.
remote: Total 48 (delta 28), reused 44 (delta 25), pack-reused 1 (from 1)
Löse Unterschiede auf: 100% (28/28), abgeschlossen mit 11 lokalen Objekten.
Von https://github.com/supabase/supabase
 * [neuer Branch]          chore/update-admonition-for-when-opt-in-is-reenabled -> origin/chore/update-admonition-for-when-opt-in-is-reenabled
   757281541d..3e1d3d25e5  feat/solutions-pages               -> origin/feat/solutions-pages
 * [neuer Branch]          feat/unified-logs-inspection-panel -> origin/feat/unified-logs-inspection-panel
Bereits aktuell.
Copying .env in root to .env in supabase/docker...
Setting up AppFlowy storage...
AppFlowy storage setup will be handled by the service itself.
Setting up Affine storage...
Affine storage will be handled by Docker volumes.
Checking SearXNG settings...
SearXNG settings.yml already exists at searxng/settings.yml
Generating SearXNG secret key...
Detected Linux/Unix platform, using standard sed command...
SearXNG secret key generated successfully.
No running SearXNG container found - assuming first run
First run detected for SearXNG. Temporarily removing 'cap_drop: - ALL' directive...
Note: After the first run completes successfully, you should re-add 'cap_drop: - ALL' to docker-compose.yml for security reasons.
Stopping and removing existing containers for the unified project 'localai'...
Running: docker compose -p localai -f docker-compose.yml -f supabase/docker/docker-compose.yml down
Starting Supabase services...
Running: docker compose -p localai -f supabase/docker/docker-compose.yml up -d
[+] Running 14/14
 ✔ Network localai_default                   Created                                                                0.0s 
 ✔ Container supabase-imgproxy               Started                                                                0.4s 
 ✔ Container supabase-vector                 Healthy                                                                5.9s 
 ✔ Container supabase-db                     Healthy                                                               18.0s 
 ✔ Container supabase-analytics              Healthy                                                               17.1s 
 ✔ Container supabase-auth                   Started                                                               17.4s 
 ✔ Container supabase-studio                 Started                                                               17.3s 
 ✔ Container supabase-pooler                 Started                                                               17.4s 
 ✔ Container supabase-rest                   Started                                                               17.4s 
 ✔ Container realtime-dev.supabase-realtime  Started                                                               17.3s 
 ✔ Container supabase-meta                   Started                                                               17.3s 
 ✔ Container supabase-kong                   Started                                                               17.3s 
 ✔ Container supabase-edge-functions         Started                                                               17.3s 
 ✔ Container supabase-storage                Started                                                               18.1s 
Waiting for Supabase to initialize...
Starting local AI services...
Running: docker compose -p localai -f docker-compose.yml up -d
[+] Running 3/3
 ! appflowy-cloud     Interrupted                                                                                   1.3s 
 ✘ appflowy-web Error manifest for appflowyinc/appflowy_web:0.5.9 not found: manifest unknow...                     1.3s 
 ! appflowy-gotrue    Interrupted                                                                                   1.3s 
Error response from daemon: manifest for appflowyinc/appflowy_web:0.5.9 not found: manifest unknown: manifest unknown
Traceback (most recent call last):
  File "/home/dev/n8n-installer/./start_services.py", line 418, in <module>
    main()
  File "/home/dev/n8n-installer/./start_services.py", line 402, in main
    start_local_ai()
  File "/home/dev/n8n-installer/./start_services.py", line 126, in start_local_ai
    run_command(cmd)
  File "/home/dev/n8n-installer/./start_services.py", line 42, in run_command
    subprocess.run(cmd, cwd=cwd, check=True)
  File "/usr/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['docker', 'compose', '-p', 'localai', '-f', 'docker-compose.yml', 'up', '-d']' returned non-zero exit status 1.
dev@desktop-vm:~/n8n-installer$ 
